<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Camera</title>
<style>
body {
  background:black;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  margin:0;
}
video {
  width:480px;
  height:360px;
}
</style>
</head>
<body>

<video id="v" autoplay playsinline muted></video>
<canvas id="c" width="64" height="64" hidden></canvas>

<script>
const v = document.getElementById("v")
const c = document.getElementById("c")
const ctx = c.getContext("2d")

navigator.mediaDevices.getUserMedia({video:true})
.then(s => {
  v.srcObject = s
  v.play()
})

setInterval(() => {
  ctx.drawImage(v, 0, 0, 64, 64)
  const img = c.toDataURL("image/jpeg", 0.5).split(",")[1]

  fetch("/camera", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ image: img })
  })
}, 300)
</script>

</body>
</html>
