<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Camera</title>
<style>
body {
  margin:0;
  background:black;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
video {
  width:480px;
  height:auto;
}
</style>
</head>
<body>

<video id="v" autoplay muted playsinline></video>
<canvas id="c" width="96" height="96" hidden></canvas>

<script>
const v = document.getElementById("v")
const c = document.getElementById("c")
const ctx = c.getContext("2d")

navigator.mediaDevices.getUserMedia({ video:true })
.then(s => {
  v.srcObject = s
  v.play()
})

setInterval(() => {
  ctx.drawImage(v, 0, 0, 96, 96)
  const img = c.toDataURL("image/jpeg", 0.45).split(",")[1]

  fetch("/camera", {
    method: "POST",
    headers: { "Content-Type":"application/json" },
    body: JSON.stringify({ image: img })
  })
}, 50)
</script>

</body>
</html>
